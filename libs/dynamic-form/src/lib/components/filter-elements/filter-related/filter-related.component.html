<div class="filter-element" [class.active]="!isCollapsed">
  <label class="filter-label related" [class.active]="!isCollapsed">
    {{ config.label }}
    <fa-icon
      *ngIf="query"
      class="text-danger ml-1"
      [icon]="['fas', 'times-circle']"
      style="cursor: pointer"
      (click)="resetFilter()"
    ></fa-icon>
  </label>
  <div class="filter-related">
    <div
      class="d-flex justify-content-center align-items-center autocomplete-filter"
      style="position: relative"
    >
      <div
        class="form-control autocomplete-value"
        [class.active]="
          (multiple && selected && selected.length) ||
          (!multiple && item && item.data)
        "
        (click)="openAutocomplete($event)"
      >
        <div style="overflow: hidden; white-space: nowrap">
          {{ item ? item.displayValue : '' }}
        </div>
        <fa-icon
          [icon]="[
            'fas',
            item && item.hideAutocomplete ? 'chevron-down' : 'chevron-up'
          ]"
          class="text-md-white ml-2"
        ></fa-icon>
      </div>

      <div
        class="autocomplete"
        [hidden]="item ? item.hideAutocomplete : true"
        [ngStyle]="{ 'top.px': topHeight }"
      >
        <input
          #search="ngModel"
          *ngIf="!multiple"
          name="search"
          type="text"
          class="form-control mb-1"
          [(ngModel)]="searchValue"
          [ngModelOptions]="{ standalone: true }"
          (blur)="resetList(item)"
        />
        <ul *ngIf="multiple" class="list-group w-100">
          <li class="autocomplete-item default-value">
            <a (click)="selectAll(previewList)">Select All</a>
            <a (click)="resetAll(previewList)">Reset All</a>
          </li>
        </ul>

        <input
          #search="ngModel"
          *ngIf="multiple"
          name="search"
          type="text"
          class="form-control mt-1"
          [(ngModel)]="searchValue"
          [ngModelOptions]="{ standalone: true }"
        />

        <div
          class="autocomplete-list"
          infinite-scroll
          [infiniteScrollDistance]="modalScrollDistance"
          [infiniteScrollThrottle]="modalScrollThrottle"
          [scrollWindow]="false"
          (scrolled)="onModalScrollDown()"
        >
          <ul
            *ngIf="!multiple && previewList && previewList.length"
            class="list-group w-100"
          >
            <li
              class="list-group-item autocomplete-item"
              (click)="setValue(defaultValue, item)"
            >
              All
            </li>
            <li
              class="list-group-item autocomplete-item"
              *ngFor="let option of previewList"
              (click)="setValue(option)"
            >
              {{ option.__str__ }}
            </li>
          </ul>

          <ul
            *ngIf="multiple && previewList && previewList.length"
            class="list-group w-100"
          >
            <li
              class="list-group-item autocomplete-item form-check"
              *ngFor="let option of previewList; let index = index"
            >
              <label class="d-flex align-items-center">
                <input
                  type="checkbox"
                  class="form-check-input"
                  [(ngModel)]="option.checked"
                  name="checked"
                  (ngModelChange)="setValue(option, chashValues)"
                  hidden
                />
                <div class="custom-checkbox">
                  <svg
                    width="9"
                    height="7"
                    viewBox="0 0 9 7"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M3.08284 4.87574C2.92663 5.03195 2.67337 5.03195 2.51716 4.87574L1.12071 3.47929C0.888359 3.24694 0.511641 3.24694 0.279289 3.47929C0.0469372 3.71164 0.0469373 4.08836 0.279289 4.32071L2.37574 6.41716C2.61005 6.65147 2.98995 6.65147 3.22426 6.41716L8.52071 1.12071C8.75306 0.888359 8.75306 0.511642 8.52071 0.279289C8.28836 0.0469374 7.91164 0.0469372 7.67929 0.279289L3.08284 4.87574Z"
                      fill="white"
                      stroke="#FDFDFD"
                      stroke-width="0.2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </div>
                {{ option[config.data.value] }}
              </label>
            </li>
          </ul>
          <div
            class="d-flex align-items-center justify-content-center"
            *ngIf="skipScroll"
          >
            <app-loader></app-loader>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="selected && selected.length" class="filter-values">
      <span class="badge badge-outline" *ngFor="let value of selected">
        {{ value[config.data.value] }}
        <fa-icon
          [icon]="['fas', 'times']"
          (click)="removeItem(value)"
        ></fa-icon>
      </span>
    </div>
  </div>
</div>
