<div *ngIf="config" class="form-builder-form">
  <section class="form">
    <header class="form__header" *ngIf="steps.length > 1">
      <span class="form__steps">step {{currentStep + 1}} of {{steps.length}}</span>
      <h3 class="form__name">{{steps[currentStep].title}}</h3>
    </header>

    <div class="content">
      <app-dynamic-form
        [formBuilder]="true"
        [config]="steps[currentStep].metadata"
        [form]="form"
        [errors]="error"
        [hiddenFields]="hiddenFields"
        [hidden]="process"
        (event)="eventHandler($event)">
      </app-dynamic-form>

      <div class="text-center" *ngIf="process">
        <app-loader></app-loader>
      </div>
    </div>

    <footer class="form__footer" *ngIf="!process" [class.justify-content-center]="steps.length ===1">
      <button type="button" class="form__button btn btn-default"
        *ngIf="steps.length > 1"
        [disabled]="currentStep === 0"
        (click)="back()">
          Back
      </button>

      <div class="button-wrapper d-flex flex-column align-items-center"
        *ngIf="currentStep + 1 !== steps.length">
          <button type="button" class="form__button btn btn-primary w-100"
            [disabled]="disableNextButton || formInvalid"
            (click)="next()">
              Next step
          </button>
          <span class="error-message" *ngIf="formInvalid">
            Please fill all the REQUIRED fields
          </span>
      </div>

      <div class="button-wrapper d-flex flex-column align-items-center" *ngIf="currentStep + 1 === steps.length">
        <button type="submit" class="form__button btn btn-primary w-100"
          [disabled]="form.invalid || saveProcess"
          (click)="submitForm()">
            Register
            <app-spinner *ngIf="saveProcess"></app-spinner>
        </button>
        <span class="error-message" *ngIf="form.invalid">Please fill all the REQUIRED fields</span>
      </div>
    </footer>
  </section>
</div>

<app-toast></app-toast>
