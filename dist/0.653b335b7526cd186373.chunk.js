webpackJsonp([0],{1338:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(4),n=s(0),i=s(8),o=s(20),a=s(6),p=s(1345),u=s(1344),c=s(1342),h=s(1343),l=s(842),d=s(34),m=s(232),g=(s.n(m),s(843));s.n(g);s.d(e,"SettingsModule",(function(){return f}));var f=(function(){function t(){}return t})();f=r.a([s.i(n.NgModule)({imports:[o.a.forChild(p.a),l.a,d.a.forRoot(),i.CommonModule,a.a,m.Angular2FontawesomeModule,g.InfiniteScrollModule],declarations:[c.a,u.a],providers:[h.a]})],f)},1342:function(t,e,s){"use strict";var r=s(4),n=s(0),i=s(1343);s.d(e,"a",(function(){return o}));var o=(function(){function t(t){this.service=t,this.search={list:"",permission:"",group:""}}return t.prototype.ngOnInit=function(){this.getPermissions(),this.getGroups(),this.getUsers()},t.prototype.getGroups=function(){var t=this;this.service.getAllGroups().subscribe((function(e){t.cashGroups=e.results,t.groups=[].concat(e.results)}))},t.prototype.getUsers=function(){var t=this;this.service.getAllUsers().subscribe((function(e){t.cashUsers=e.user_list,t.users=[].concat(e.user_list)}))},t.prototype.getPermissions=function(){var t=this;this.service.getAllPermissions().subscribe((function(e){t.cashPermissions=e.permission_list,t.permissionsList=[].concat(t.cashPermissions)}))},t.prototype.toggle=function(t,e,s){if("list"===t)return this.getPermissionsOf(s.id,e),"user"===e&&this.getGroupsOfUser(s.id),this.targetId=s.id,this.resetData(this.groups),void this.resetData(this.permissionsList);"permission"===t?this.togglePermissions(s,e):"group"===t&&this.toggleGroup(s)},t.prototype.togglePermissions=function(t,e){t.active?("user"===e&&this.service.revokePermissionsOfTheUser(this.targetId,[t.id]).subscribe((function(e){return t.active=!1})),"group"===e&&this.service.revokePermissionsOfTheGroup(this.targetId,[t.id]).subscribe((function(e){return t.active=!1}))):("user"===e&&this.service.addPermissionsOnTheUser(this.targetId,[t.id]).subscribe((function(e){return t.active=!0})),"group"===e&&this.service.addPermissionsOnTheGroup(this.targetId,[t.id]).subscribe((function(e){return t.active=!0})))},t.prototype.toggleGroup=function(t){t.active?t.active&&this.service.removeUserOnTheGroup(t.id,this.targetId).subscribe((function(e){t.active=!1})):this.service.addUserOnTheGroup(t.id,this.targetId).subscribe((function(e){t.active=!0}))},t.prototype.addGroup=function(t){var e=this;this.service.createGroup(t).subscribe((function(t){e.name="",e.getGroups()}))},t.prototype.removeGroup=function(t,e){var s=this;e.preventDefault(),e.stopPropagation(),this.service.deleteGroup(t.id).subscribe((function(e){s.cashGroups.splice(s.groups.indexOf(t),1),s.groups.splice(s.groups.indexOf(t),1)}))},t.prototype.getPermissionsOf=function(t,e){var s=this;"user"===e&&this.service.getPermissionsOfUser(t).subscribe((function(t){s.targetPermissions=t.results,s.combineElement(s.targetPermissions,s.permissionsList)})),"group"===e&&this.service.getAllPermissionsOfTheGroup(t).subscribe((function(t){s.targetPermissions=t.results,s.combineElement(s.targetPermissions,s.permissionsList)}))},t.prototype.getGroupsOfUser=function(t){var e=this;this.service.getGroupsOnTheUser(t).subscribe((function(t){e.targetGroups=t.results,e.combineElement(e.targetGroups,e.groups)}))},t.prototype.combineElement=function(t,e){e.forEach((function(e){t.forEach((function(t){e.id===t.id&&(e.active=!0)}))}))},t.prototype.filter=function(t,e,s,r){e="list"===e?r:e;var n="user"===e?this.cashUsers:"group"===e?this.cashGroups:"permission"===e?this.cashPermissions:null;if(t&&n){s.length=0;var i=n.filter((function(e){var s=e.name;if(s)return s.toLowerCase().indexOf(t.toLowerCase())>-1}));s.push.apply(s,i)}else s.length=0,s=n?s.push.apply(s,n):[]},t.prototype.beforeChange=function(){this.targetId=void 0,this.search.list="",this.search.group="",this.search.permission="",this.targetPermissions=[],this.targetGroups=[],this.groups.length=0,this.permissionsList.length=0,this.groups=[].concat(this.cashGroups),this.permissionsList=[].concat(this.cashPermissions),this.resetData(this.groups),this.resetData(this.permissionsList)},t.prototype.resetData=function(t){t.forEach((function(t){delete t.active}))},t})();o=r.a([s.i(n.Component)({selector:"permissions",template:s(1346)}),r.b("design:paramtypes",[i.a])],o)},1343:function(t,e,s){"use strict";var r=s(4),n=s(0),i=s(162),o=s(5),a=(s.n(o),s(122)),p=(s.n(a),s(233)),u=(s.n(p),s(387));s.n(u);s.d(e,"a",(function(){return c}));var c=(function(){function t(t,e){this.http=t,this.cookie=e,this.endpoints={base:"ecore/api/v2/permissions/",user:"ecore/api/v2/permissions/user/",group:"ecore/api/v2/permissions/group/",users:"ecore/api/v2/company_settings/users/",all:"all/",add:"set/",create:"create/",addUser:"add_user/",removeUser:"remove_user/",revoke:"revoke/",delete:"delete/",groups:"groups/"}}return t.prototype.getAllPermissions=function(t){var e=this;void 0===t&&(t=void 0);var s=""+this.endpoints.base+this.endpoints.all+"?limit=-1",r=this.updateHeaders();return this.http.get(s,{headers:r}).map((function(t){return t.json()})).catch((function(t){return e.errorHandler(t)}))},t.prototype.getAllUsers=function(){var t=this,e=""+this.endpoints.users,s=this.updateHeaders();return this.http.get(e,{headers:s}).map((function(t){return t.json()})).catch((function(e){return t.errorHandler(e)}))},t.prototype.getPermissionsOfUser=function(t){var e=this,s=""+this.endpoints.user+t+"/",r=this.updateHeaders();return this.http.get(s,{headers:r}).map((function(t){return t.json()})).catch((function(t){return e.errorHandler(t)}))},t.prototype.addPermissionsOnTheUser=function(t,e){var s=this,r=""+this.endpoints.user+t+"/"+this.endpoints.add,n={permission_list:e},i=this.updateHeaders();return this.http.post(r,n,{headers:i}).map((function(t){return o.Observable.of(t)})).catch((function(t){return s.errorHandler(t)}))},t.prototype.getGroupsOnTheUser=function(t){var e=this,s=""+this.endpoints.user+t+"/"+this.endpoints.groups,r=this.updateHeaders();return this.http.get(s,{headers:r}).map((function(t){return t.json()})).catch((function(t){return e.errorHandler(t)}))},t.prototype.revokePermissionsOfTheUser=function(t,e){var s=this,r=""+this.endpoints.user+t+"/"+this.endpoints.revoke,n={permission_list:e},i=this.updateHeaders();return this.http.post(r,n,{headers:i}).map((function(t){return o.Observable.of(t)})).catch((function(t){return s.errorHandler(t)}))},t.prototype.getAllGroups=function(){var t=this,e=""+this.endpoints.base+this.endpoints.groups,s=this.updateHeaders();return this.http.get(e,{headers:s}).map((function(t){return t.json()})).catch((function(e){return t.errorHandler(e)}))},t.prototype.getAllPermissionsOfTheGroup=function(t){var e=this,s=""+this.endpoints.group+t+"/",r=this.updateHeaders();return this.http.get(s,{headers:r}).map((function(t){return t.json()})).catch((function(t){return e.errorHandler(t)}))},t.prototype.createGroup=function(t){var e=this,s=""+this.endpoints.base+this.endpoints.groups+this.endpoints.create,r={name:t},n=this.updateHeaders();return this.http.post(s,r,{headers:n}).map((function(t){return o.Observable.of(t)})).catch((function(t){return e.errorHandler(t)}))},t.prototype.deleteGroup=function(t){var e=this,s=""+this.endpoints.group+t+"/"+this.endpoints.delete,r=this.updateHeaders();return this.http.get(s,{headers:r}).map((function(t){return t.json()})).catch((function(t){return e.errorHandler(t)}))},t.prototype.addPermissionsOnTheGroup=function(t,e){var s=this,r=""+this.endpoints.group+t+"/"+this.endpoints.add,n={permission_list:e},i=this.updateHeaders();return this.http.post(r,n,{headers:i}).map((function(t){return o.Observable.of(t)})).catch((function(t){return s.errorHandler(t)}))},t.prototype.addUserOnTheGroup=function(t,e){var s=this,r=""+this.endpoints.group+t+"/"+this.endpoints.addUser,n={user_id:e},i=this.updateHeaders();return this.http.post(r,n,{headers:i}).map((function(t){return o.Observable.of(t)})).catch((function(t){return s.errorHandler(t)}))},t.prototype.removeUserOnTheGroup=function(t,e){var s=this,r=""+this.endpoints.group+t+"/"+this.endpoints.removeUser,n={user_id:e},i=this.updateHeaders();return this.http.post(r,n,{headers:i}).map((function(t){return o.Observable.of(t)})).catch((function(t){return s.errorHandler(t)}))},t.prototype.revokePermissionsOfTheGroup=function(t,e){var s=this,r=""+this.endpoints.group+t+"/"+this.endpoints.revoke,n={permission_list:e},i=this.updateHeaders();return this.http.post(r,n,{headers:i}).map((function(t){return o.Observable.of(t)})).catch((function(t){return s.errorHandler(t)}))},t.prototype.updateHeaders=function(){var t=new i.b;return t.append("X-CSRFToken",this.cookie.get("csrftoken")),t},t.prototype.errorHandler=function(t){return o.Observable.throw(t.json()||"Server error.")},t})();c=r.a([s.i(n.Injectable)(),r.b("design:paramtypes",[i.c,u.CookieService])],c)},1344:function(t,e,s){"use strict";var r=s(4),n=s(0),i=s(20);s.d(e,"a",(function(){return o}));var o=(function(){function t(t){this.route=t}return t.prototype.ngOnInit=function(){this.user=this.route.snapshot.data.user.data,this.pagesList=this.route.snapshot.data.pagesList},t})();o=r.a([s.i(n.Component)({selector:"settings-page",template:s(1347)}),r.b("design:paramtypes",[i.d])],o)},1345:function(t,e,s){"use strict";var r=s(1342),n=s(1344);s.d(e,"a",(function(){return i}));var i=[{path:"",component:n.a,children:[{path:"permissions",component:r.a},{path:"permissions/:id",component:r.a}]}]},1346:function(t,e){t.exports='<div class="my-3">\n  <ngb-tabset type="pills" (tabChange)="beforeChange()">\n    <ngb-tab id="group" title="Groups">\n      <template ngbTabContent>\n        <div class="permission-block-add form-inline">\n          <input type="text" class="permission-input form-control mr-2" [(ngModel)]="name">\n          <button type="button" class="btn bg-default" (click)="addGroup(name)">Add</button>\n        </div>\n        <div class="permission-wrapper">\n          <template\n            [ngTemplateOutlet]="list"\n            [ngOutletContext]="{title: \'Groups\', list: groups, param: \'name\', element: \'group\', type: \'list\'}">\n          </template>\n          <template *ngIf="targetId"\n            [ngTemplateOutlet]="list"\n            [ngOutletContext]="{title: \'Permissions\', list: permissionsList, param: \'name\', element: \'group\', type: \'permission\'}">\n          </template>\n        </div>\n      </template>\n    </ngb-tab>\n    <ngb-tab id="user" title="Users">\n      <template ngbTabContent>\n        <div class="permission-wrapper">\n          <template\n            [ngTemplateOutlet]="list"\n            [ngOutletContext]="{title: \'Users\', list: users, param: \'name\', element: \'user\', type: \'list\'}">\n          </template>\n          <template *ngIf="targetId"\n            [ngTemplateOutlet]="list"\n            [ngOutletContext]="{title: \'Permissions\', list: permissionsList, param: \'name\', element: \'user\', type: \'permission\'}">\n          </template>\n          <template *ngIf="targetId"\n            [ngTemplateOutlet]="list"\n            [ngOutletContext]="{title: \'Groups\', list: groups, param: \'name\', element: \'user\', type: \'group\'}">\n          </template>\n        </div>\n      </template>\n    </ngb-tab>\n  </ngb-tabset>\n</div>\n\n<template #list let-t="title" let-l="list" let-p="param" let-a="actions" let-type="type" let-e="element">\n  <div class="permission-block-wrapper">\n    <b class="permission-block-title">{{t}}:</b>\n    <div class="permission-search">\n      <input type="text"\n        [(ngModel)]="search[type]"\n        class="form-control w-100 mb-2"\n        (keyup)="filter(search[type], type, l, e)">\n      <i fa [name]="\'search\'" class="permission-search-icon text-muted"></i>\n    </div>\n    <div class="permission-block">\n      <div class="permission-item"\n        [class.active]="item.active"\n        [class.selected]="item.id === targetId && type === \'list\'"\n        *ngFor="let item of l"\n        (click)="toggle(type, e, item)">\n          {{item[p]}}\n          <i fa\n            class="permission-icon text-danger"\n            *ngIf="e === \'group\' && type === \'list\'"\n            [name]="\'trash\'"\n            (click)="removeGroup(item, $event)">\n          </i>\n        </div>\n    </div>\n  </div>\n</template>\n'},1347:function(t,e){t.exports='<navigation [user]="user" [pages]="pagesList"></navigation>\n<breadcrumb [navigationList]="pagesList"></breadcrumb>\n<div class="container">\n    <router-outlet></router-outlet>\n</div>\n'}});